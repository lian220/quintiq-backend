# ë°°í¬ ë° ìš´ì˜ ê°€ì´ë“œ

**ëª©ì **: QuantIQ ì‹œìŠ¤í…œ ë°°í¬ ë° ìš´ì˜ ë°©ë²•
**ëŒ€ìƒ**: DevOps ì—”ì§€ë‹ˆì–´, ì‹œìŠ¤í…œ ê´€ë¦¬ì
**ì‘ì„±ì¼**: 2026-01-31

---

## ğŸ“‹ ëª©ì°¨

1. [ë¡œì»¬ ë°°í¬](#ë¡œì»¬-ë°°í¬)
2. [í¬íŠ¸ ë§¤í•‘](#í¬íŠ¸-ë§¤í•‘)
3. [í™˜ê²½ ì„¤ì •](#í™˜ê²½-ì„¤ì •)
4. [ê¸°ë³¸ ëª…ë ¹ì–´](#ê¸°ë³¸-ëª…ë ¹ì–´)
5. [í”„ë¡œë•ì…˜ ë°°í¬](#í”„ë¡œë•ì…˜-ë°°í¬)

---

## ë¡œì»¬ ë°°í¬

ì „ì²´ ì‹œìŠ¤í…œì€ **Docker Compose**ë¥¼ í†µí•´ ê´€ë¦¬ë©ë‹ˆë‹¤.

### ì‹œìŠ¤í…œ êµ¬ì„±

```
quantiq/
â”œâ”€â”€ quantiq-core/           # Spring Boot (Kotlin)
â”œâ”€â”€ quantiq-data-engine/    # FastAPI (Python)
â”œâ”€â”€ docker-compose.yml      # ì„œë¹„ìŠ¤ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜
â””â”€â”€ .env                    # í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
```

### ë°°í¬ ìˆœì„œ

1. **í™˜ê²½ ë³€ìˆ˜ ì„¤ì •**
```bash
# .env íŒŒì¼ ìƒì„± (.env.sample ì°¸ê³ )
cp .env.sample .env

# í•„ìˆ˜ í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
vim .env
```

2. **Docker Composeë¡œ ì‹œì‘**
```bash
# ëª¨ë“  ì„œë¹„ìŠ¤ ì‹œì‘
docker-compose up -d

# ë¡œê·¸ í™•ì¸
docker-compose logs -f
```

3. **í—¬ìŠ¤ ì²´í¬**
```bash
# Spring Boot í—¬ìŠ¤ ì²´í¬
curl http://localhost:10010/actuator/health

# Python Engine í—¬ìŠ¤ ì²´í¬
curl http://localhost:10020/health
```

---

## í¬íŠ¸ ë§¤í•‘

| ì„œë¹„ìŠ¤ | ë‚´ë¶€ í¬íŠ¸ | í˜¸ìŠ¤íŠ¸ í¬íŠ¸ | ìš©ë„ |
|--------|---------|------------|------|
| **Spring Core** | 8080 | **10010** | REST API, ìŠ¤ì¼€ì¤„ëŸ¬ |
| **Python Engine** | 8000 | **10020** | ë°ì´í„° ìˆ˜ì§‘, ë¶„ì„ ì—”ì§„ |
| **MongoDB** | 27017 | 27017 | NoSQL ë°ì´í„°ë² ì´ìŠ¤ |
| **PostgreSQL** | 5432 | 5432 | RDB ë°ì´í„°ë² ì´ìŠ¤ |
| **Kafka** | 9092 | 9092 | ë©”ì‹œì§€ ë¸Œë¡œì»¤ |
| **Zookeeper** | 2181 | 2181 | Kafka ì½”ë””ë„¤ì´í„° |

### í¬íŠ¸ ì¶©ëŒ í•´ê²°

```bash
# í¬íŠ¸ ì‚¬ìš© ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ í™•ì¸
lsof -i :10010
lsof -i :10020

# í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ
kill -9 <PID>

# ë˜ëŠ” docker-compose.ymlì—ì„œ í¬íŠ¸ ë³€ê²½
```

---

## í™˜ê²½ ì„¤ì •

### í•„ìˆ˜ í™˜ê²½ ë³€ìˆ˜

`.env` íŒŒì¼ì— ë‹¤ìŒ ë³€ìˆ˜ë“¤ì„ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤:

```bash
# ===== API Keys =====
FRED_API_KEY=your_fred_api_key_here
KIS_APP_KEY=your_kis_app_key_here
KIS_APP_SECRET=your_kis_app_secret_here
SLACK_BOT_TOKEN=xoxb-your-slack-bot-token
SLACK_CHANNEL_ID=C1234567890

# ===== Database =====
MONGODB_URI=mongodb://mongodb:27017/quantiq
POSTGRES_HOST=postgresql
POSTGRES_PORT=5432
POSTGRES_DB=quantiq
POSTGRES_USER=quantiq_user
POSTGRES_PASSWORD=quantiq_password

# ===== Kafka =====
KAFKA_BOOTSTRAP_SERVERS=kafka:29092
KAFKA_TOPIC_STOCK_RECOMMENDATIONS=quantiq.stock.recommendations
KAFKA_TOPIC_ANALYSIS_COMPLETED=quantiq.analysis.completed

# ===== Application =====
SPRING_PROFILES_ACTIVE=local
LOG_LEVEL=INFO
```

### í™˜ê²½ë³„ ì„¤ì •

#### ë¡œì»¬ ê°œë°œ í™˜ê²½
```yaml
# application-local.yml
spring:
  profiles: local
  datasource:
    url: jdbc:postgresql://localhost:5432/quantiq
logging:
  level:
    com.quantiq: DEBUG
```

#### í”„ë¡œë•ì…˜ í™˜ê²½
```yaml
# application-prod.yml
spring:
  profiles: prod
  datasource:
    url: jdbc:postgresql://db.production.com:5432/quantiq
    hikari:
      maximum-pool-size: 20
logging:
  level:
    com.quantiq: INFO
```

---

## ê¸°ë³¸ ëª…ë ¹ì–´

### ì‹œì‘ ë° ì¤‘ì§€

```bash
# ëª¨ë“  ì„œë¹„ìŠ¤ ì‹œì‘
docker-compose up -d

# íŠ¹ì • ì„œë¹„ìŠ¤ë§Œ ì‹œì‘
docker-compose up -d quantiq-core
docker-compose up -d quantiq-data-engine

# ëª¨ë“  ì„œë¹„ìŠ¤ ì •ì§€
docker-compose stop

# ëª¨ë“  ì„œë¹„ìŠ¤ ì œê±° (ì»¨í…Œì´ë„ˆ ì‚­ì œ)
docker-compose down

# ë³¼ë¥¨ í¬í•¨ ì™„ì „ ì œê±° (ë°ì´í„° ì‚­ì œ ì£¼ì˜!)
docker-compose down -v
```

### ë¹Œë“œ ë° ì¬ì‹œì‘

```bash
# ì´ë¯¸ì§€ ì¬ë¹Œë“œ í›„ ì‹œì‘
docker-compose up --build -d

# íŠ¹ì • ì„œë¹„ìŠ¤ë§Œ ì¬ë¹Œë“œ
docker-compose build quantiq-core
docker-compose up -d quantiq-core

# ì„œë¹„ìŠ¤ ì¬ì‹œì‘ (ì´ë¯¸ì§€ ì¬ë¹Œë“œ ì—†ì´)
docker-compose restart
```

### ë¡œê·¸ í™•ì¸

```bash
# ì „ì²´ ë¡œê·¸ í™•ì¸ (ì‹¤ì‹œê°„)
docker-compose logs -f

# íŠ¹ì • ì„œë¹„ìŠ¤ ë¡œê·¸ë§Œ í™•ì¸
docker-compose logs -f quantiq-core
docker-compose logs -f quantiq-data-engine

# ìµœê·¼ 100ì¤„ë§Œ ë³´ê¸°
docker-compose logs --tail=100 quantiq-core

# íŠ¹ì • ì‹œê°„ ì´í›„ ë¡œê·¸
docker-compose logs --since 2026-01-31T09:00:00 quantiq-core
```

### ì»¨í…Œì´ë„ˆ ê´€ë¦¬

```bash
# ì‹¤í–‰ ì¤‘ì¸ ì»¨í…Œì´ë„ˆ í™•ì¸
docker-compose ps

# íŠ¹ì • ì»¨í…Œì´ë„ˆ ì ‘ì†
docker-compose exec quantiq-core bash
docker-compose exec quantiq-data-engine bash
docker-compose exec postgresql psql -U quantiq_user -d quantiq
docker-compose exec mongodb mongosh quantiq

# ì»¨í…Œì´ë„ˆ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰
docker stats
```

---

## í”„ë¡œë•ì…˜ ë°°í¬

### ë°°í¬ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] í™˜ê²½ ë³€ìˆ˜ ì„¤ì • ì™„ë£Œ (.env íŒŒì¼)
- [ ] API í‚¤ ë°œê¸‰ ë° ê²€ì¦ (FRED, KIS, Slack)
- [ ] ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…
- [ ] ë””ìŠ¤í¬ ê³µê°„ í™•ì¸ (ìµœì†Œ 10GB ê¶Œì¥)
- [ ] ë°©í™”ë²½ ì„¤ì • (í•„ìš”í•œ í¬íŠ¸ ì˜¤í”ˆ)
- [ ] SSL ì¸ì¦ì„œ ì„¤ì • (HTTPS)
- [ ] ëª¨ë‹ˆí„°ë§ ë„êµ¬ ì„¤ì • (Grafana, Prometheus)

### ë°°í¬ ë‹¨ê³„

#### 1. ì½”ë“œ ë°°í¬

```bash
# Gitì—ì„œ ìµœì‹  ì½”ë“œ ë°›ê¸°
git pull origin main

# ë¹Œë“œ ë° í…ŒìŠ¤íŠ¸
cd quantiq-core
./gradlew clean build

cd ../quantiq-data-engine
pytest
```

#### 2. ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…

```bash
# PostgreSQL ë°±ì—…
docker-compose exec postgresql pg_dump -U quantiq_user quantiq > backup-$(date +%Y%m%d).sql

# MongoDB ë°±ì—…
docker-compose exec mongodb mongodump --db quantiq --out /backup
```

#### 3. ì„œë¹„ìŠ¤ ì¤‘ì§€ ë° ì—…ë°ì´íŠ¸

```bash
# ë¬´ì¤‘ë‹¨ ë°°í¬ë¥¼ ìœ„í•œ Blue-Green ë°°í¬ ê¶Œì¥
# ë˜ëŠ” Rolling Update

# 1. ìƒˆ ì´ë¯¸ì§€ ë¹Œë“œ
docker-compose build

# 2. ì„œë¹„ìŠ¤ ì¬ì‹œì‘ (ìˆœì°¨ì )
docker-compose up -d --no-deps --build quantiq-data-engine
sleep 10
docker-compose up -d --no-deps --build quantiq-core
```

#### 4. í—¬ìŠ¤ ì²´í¬

```bash
# ì• í”Œë¦¬ì¼€ì´ì…˜ í—¬ìŠ¤ ì²´í¬
curl http://localhost:10010/actuator/health
curl http://localhost:10020/health

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í™•ì¸
docker-compose exec postgresql psql -U quantiq_user -d quantiq -c "SELECT 1"
docker-compose exec mongodb mongosh --eval "db.adminCommand('ping')"
```

#### 5. ëª¨ë‹ˆí„°ë§

```bash
# ë¡œê·¸ ëª¨ë‹ˆí„°ë§
docker-compose logs -f --tail=100

# ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§
docker stats

# Kafka í† í”½ í™•ì¸
docker-compose exec kafka kafka-topics.sh --bootstrap-server localhost:9092 --list
```

### ë¡¤ë°± ì ˆì°¨

```bash
# 1. ì´ì „ ë²„ì „ ì´ë¯¸ì§€ë¡œ ë¡¤ë°±
docker-compose down
docker tag quantiq-core:latest quantiq-core:backup
docker tag quantiq-core:previous quantiq-core:latest
docker-compose up -d

# 2. ë°ì´í„°ë² ì´ìŠ¤ ë¡¤ë°± (ë°±ì—… ë³µì›)
docker-compose exec postgresql psql -U quantiq_user -d quantiq < backup-20260131.sql
```

---

## ìš´ì˜ ëª¨ë‹ˆí„°ë§

### ì£¼ìš” ë©”íŠ¸ë¦­

| ë©”íŠ¸ë¦­ | ì„ê³„ê°’ | ì¡°ì¹˜ |
|--------|--------|------|
| CPU ì‚¬ìš©ë¥  | > 80% | ìŠ¤ì¼€ì¼ ì•„ì›ƒ ê³ ë ¤ |
| ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥  | > 85% | ë©”ëª¨ë¦¬ ì¦ì„¤ |
| ë””ìŠ¤í¬ ì‚¬ìš©ë¥  | > 90% | ë¡œê·¸ ì •ë¦¬, ë””ìŠ¤í¬ ì¦ì„¤ |
| API ì‘ë‹µ ì‹œê°„ | > 1ì´ˆ | ì¿¼ë¦¬ ìµœì í™” |
| Kafka Lag | > 1000 | Consumer ìŠ¤ì¼€ì¼ ì•„ì›ƒ |

### ì•Œë¦¼ ì„¤ì •

```bash
# Slack ì•Œë¦¼ í…ŒìŠ¤íŠ¸
curl -X POST http://localhost:10010/api/notifications/test

# ì£¼ìš” ì•Œë¦¼ ì¢…ë¥˜
# - ì„œë¹„ìŠ¤ ë‹¤ìš´
# - API ì—ëŸ¬ìœ¨ > 5%
# - ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨
# - ë””ìŠ¤í¬ ê³µê°„ ë¶€ì¡±
```

---

## íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ì„œë¹„ìŠ¤ê°€ ì‹œì‘ë˜ì§€ ì•ŠìŒ

```bash
# 1. ë¡œê·¸ í™•ì¸
docker-compose logs quantiq-core

# 2. í™˜ê²½ ë³€ìˆ˜ í™•ì¸
docker-compose config

# 3. í¬íŠ¸ ì¶©ëŒ í™•ì¸
lsof -i :10010
```

### ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨

```bash
# PostgreSQL ìƒíƒœ í™•ì¸
docker-compose exec postgresql pg_isready

# MongoDB ìƒíƒœ í™•ì¸
docker-compose exec mongodb mongosh --eval "db.serverStatus()"

# ë„¤íŠ¸ì›Œí¬ í™•ì¸
docker-compose exec quantiq-core ping postgresql
```

### Kafka ë©”ì‹œì§€ ëˆ„ë½

```bash
# Consumer Group í™•ì¸
docker-compose exec kafka kafka-consumer-groups.sh \
  --bootstrap-server localhost:9092 \
  --describe \
  --group quantiq-core-consumer

# í† í”½ ë©”ì‹œì§€ í™•ì¸
docker-compose exec kafka kafka-console-consumer.sh \
  --bootstrap-server localhost:9092 \
  --topic quantiq.analysis.completed \
  --from-beginning
```

---

## ê´€ë ¨ ë¬¸ì„œ

- [ë¡œì»¬ í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ](./ë¡œì»¬_í…ŒìŠ¤íŠ¸_ê°€ì´ë“œ.md)
- [í™˜ê²½ ì„¤ì • ê°€ì´ë“œ](./í™˜ê²½ì„¤ì •_ê°€ì´ë“œ.md)
- [ëª…ë ¹ì–´ ê°€ì´ë“œ](./ëª…ë ¹ì–´_ê°€ì´ë“œ.md)
- [ìŠ¤ì¼€ì¤„ëŸ¬ ìš´ì˜ ê°€ì´ë“œ](./ìŠ¤ì¼€ì¤„ëŸ¬_ìš´ì˜_ê°€ì´ë“œ.md)

---

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2026-01-31
**ë²„ì „**: 2.0 (í•œê¸€í™” ë° ìƒì„¸í™”)
**ì‘ì„±ì**: QuantIQ Development Team
